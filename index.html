<!DOCTYPE html>
<html>
<head>
    <title>üåà ÂΩ©Ëâ≤Ë≤™È£üËõá - Slither.ioÈ¢®Ê†º</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            height: 100vh; overflow: hidden; 
            background: radial-gradient(circle at center, #1a237e 0%, #0d47a1 50%, #000 100%);
            font-family: 'Arial Black', Arial; color: white; user-select: none;
            display: flex; justify-content: center; align-items: center;
        }
        .ui { position: absolute; z-index: 100; font-weight: bold; text-shadow: 2px 2px 4px #000; }
        .score { top: 20px; left: 20px; font-size: 24px; }
        .top-right { top: 20px; right: 20px; font-size: 20px; }
        canvas { 
            border-radius: 10px; box-shadow: 0 0 50px rgba(0,255,255,0.3);
            background: radial-gradient(circle, #667eea22 0%, #764ba222 70%, transparent);
            max-width: 95vw; max-height: 95vh;
        }
        .menu { 
            position: absolute; top: 0; left: 0; right: 0; bottom: 0; 
            background: rgba(0,0,0,0.9); backdrop-filter: blur(20px);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            gap: 30px;
        }
        .color-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px; }
        .color-btn { 
            width: 60px; height: 60px; border-radius: 50%; border: 4px solid rgba(255,255,255,0.3);
            cursor: pointer; transition: all 0.3s; position: relative;
        }
        .color-btn:hover { transform: scale(1.2); filter: brightness(1.3); }
        .color-btn.selected { border-color: white; box-shadow: 0 0 20px white; }
        .color-btn::after { content: attr(data-name); position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%); font-size: 12px; white-space: nowrap; }
        h1 { font-size: 48px; background: linear-gradient(45deg, #00f5ff, #ff00ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        button { 
            padding: 15px 40px; font-size: 20px; font-weight: bold; border: none; border-radius: 25px;
            background: linear-gradient(45deg, #00f5ff, #0099cc); color: #000; cursor: pointer;
            box-shadow: 0 8px 25px rgba(0,245,255,0.4);
        }
        button:hover { transform: translateY(-3px); box-shadow: 0 12px 30px rgba(0,245,255,0.6); }
    </style>
</head>
<body>
    <div class="ui score">üêç <span id="score">0</span></div>
    <div class="ui top-right">
        <div>Èï∑Â∫¶: <span id="length">5</span></div>
        <div>ÈÄüÂ∫¶: <span id="speed">1x</span></div>
    </div>

    <div class="menu" id="menu">
        <h1>üåà ÂΩ©Ëâ≤ËõáÁéã</h1>
        <div class="color-grid" id="colorGrid"></div>
        <button onclick="startGame()">üöÄ ÈñãÂßãÈÅäÊà≤</button>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const menu = document.getElementById('menu');
        const scoreEl = document.getElementById('score');
        const lengthEl = document.getElementById('length');
        const speedEl = document.getElementById('speed');

        // ÈüøÊáâÂºèÁï´Â∏É
        function resizeCanvas() {
            canvas.width = Math.min(window.innerWidth * 0.9, 800);
            canvas.height = Math.min(window.innerHeight * 0.9, 600);
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        const gridSize = 20;
        let snake = [{x: 10, y: 10}];
        let food = {}; let particles = [];
        let dx = 0, dy = 0, score = 0, gameSpeed = 150;
        let gameRunning = false, snakeColor = '#00ff88';

        // 16Á®ÆÁÇ´ÈÖ∑Êº∏ËÆäÈ°èËâ≤
        const colors = [
            {name:'Áø†Á∂†', color: '#00ff88'},
            {name:'ÈõªÁ¥´', color: '#aa00ff'},
            {name:'ÁÉàÁÑ∞', color: '#ff4444'},
            {name:'Êµ∑Ê¥ã', color: '#00ccff'},
            {name:'ÈáëÈªÉ', color: '#ffd700'},
            {name:'Á≤âÁ¥Ö', color: '#ff69b4'},
            {name:'ÂÜ∞Ëóç', color: '#00bfff'},
            {name:'Ê©òÁ¥Ö', color: '#ff8c00'},
            {name:'ËñÑËç∑', color: '#98fb98'},
            {name:'ÈùõËóç', color: '#4b0082'},
            {name:'Ê´ªËä±', color: '#ffb6c1'},
            {name:'ËêäÂßÜ', color: '#32cd32'},
            {name:'ÈúìËôπ', color: '#ff1493'},
            {name:'Â§©Èùí', color: '#20b2aa'},
            {name:'Ëñ∞Ë°£', color: '#dda0dd'},
            {name:'Â§úÂÖâ', color: '#00ffff'}
        ];

        // Âª∫Á´ãÈ°èËâ≤ÈÅ∏ÂñÆ
        const colorGrid = document.getElementById('colorGrid');
        colors.forEach((color, i) => {
            const btn = document.createElement('div');
            btn.className = 'color-btn';
            btn.style.background = `linear-gradient(45deg, ${color.color}, ${adjustBrightness(color.color, 0.7)})`;
            btn.dataset.color = color.color;
            btn.dataset.name = color.name;
            btn.onclick = () => selectColor(i);
            colorGrid.appendChild(btn);
        });
        function selectColor(index) {
            document.querySelectorAll('.color-btn').forEach(btn => btn.classList.remove('selected'));
            document.querySelectorAll('.color-btn')[index].classList.add('selected');
            snakeColor = colors[index].color;
        }

        function adjustBrightness(hex, factor) {
            const r = Math.floor(parseInt(hex.slice(1,3),16) * factor);
            const g = Math.floor(parseInt(hex.slice(3,5),16) * factor);
            const b = Math.floor(parseInt(hex.slice(5,7),16) * factor);
            return `rgb(${r},${g},${b})`;
        }

        function startGame() {
            menu.style.display = 'none';
            gameRunning = true;
            gameLoop();
        }

        function randomFood() {
            food = {
                x: Math.floor(Math.random() * (canvas.width / gridSize)),
                y: Math.floor(Math.random() * (canvas.height / gridSize))
            };
        }

        function createParticles(x, y) {
            for(let i = 0; i < 8; i++) {
                particles.push({
                    x, y,
                    vx: (Math.random() - 0.5) * 4,
                    vy: (Math.random() - 0.5) * 4,
                    life: 30,
                    color: snakeColor
                });
            }
        }

        function updateParticles() {
            particles = particles.filter(p => {
                p.x += p.vx; p.y += p.vy; p.life--;
                p.vx *= 0.95; p.vy *= 0.95;
                return p.life > 0;
            });
        }

        function drawBackground() {
            const gradient = ctx.createRadialGradient(canvas.width/2, canvas.height/2, 0, canvas.width/2, canvas.height/2, Math.max(canvas.width, canvas.height)/2);
            gradient.addColorStop(0, 'rgba(255,255,255,0.1)');
            gradient.addColorStop(0.5, 'rgba(0,150,255,0.05)');
            gradient.addColorStop(1, 'rgba(0,0,0,0.3)');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Á∂≤Ê†ºÁ∑ö
            ctx.strokeStyle = 'rgba(255,255,255,0.08)';
            ctx.lineWidth = 1;
            for(let i = 0; i < canvas.width; i += gridSize) {
                ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, canvas.height); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(canvas.width, i); ctx.stroke();
            }
        }

        function drawSnake() {
            snake.forEach((segment, i) => {
                const x = segment.x * gridSize;
                const y = segment.y * gridSize;
                const size = i === 0 ? gridSize * 0.9 : gridSize * 0.8;
                const glowSize = i === 0 ? gridSize * 1.2 : gridSize;

                // ËõáË∫´ÁôºÂÖâ
                ctx.shadowColor = snakeColor;
                ctx.shadowBlur = 25;
                ctx.fillStyle = i === 0 ? snakeColor : adjustBrightness(snakeColor, 0.7);
                ctx.beginPath();
                ctx.arc(x + gridSize/2, y + gridSize/2, size/2, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
            });
        }

        function drawFood() {
            const fx = food.x * gridSize + gridSize/2;
            const fy = food.y * gridSize + gridSize/2;
            ctx.shadowColor = '#ff4444';
            ctx.shadowBlur = 20;
            ctx.fillStyle = '#ff6666';
            ctx.beginPath();
            ctx.arc(fx, fy, gridSize/3, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;
        }

        function drawParticles() {
            particles.forEach(p => {
                ctx.save();
                ctx.globalAlpha = p.life / 30;
                ctx.shadowColor = p.color;
                ctx.shadowBlur = 10;
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            });
        }

        function moveSnake() {
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // ÈÇäÁïåÂåÖË£ù
            if (head.x < 0) head.x = Math.floor(canvas.width / gridSize) - 1;
            if (head.x >= canvas.width / gridSize) head.x = 0;
            if (head.y < 0) head.y = Math.floor(canvas.height / gridSize) - 1;
            if (head.y >= canvas.height / gridSize) head.y = 0;

            // Á¢∞ÊíûÊ™¢Ê∏¨
            for(let i = 0; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    gameOver();
                    return;
                }
            }

            snake.unshift(head);
            
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                lengthEl.textContent = snake.length;
                speedEl.textContent = `${Math.floor(snake.length/10)}x`;
                gameSpeed = Math.max(80, 150 - snake.length * 2);
                scoreEl.textContent = score;
                createParticles(food.x * gridSize, food.y * gridSize);
                randomFood();
            } else {
                snake.pop();
            }
        }

        function gameOver() {
            gameRunning = false;
            setTimeout(() => {
                menu.style.display = 'flex';
                document.querySelector('.color-btn').click(); // È†êÈÅ∏Á¨¨‰∏ÄÂÄãÈ°èËâ≤
            }, 500);
        }

        function gameLoop() {
            const interval = setInterval(() => {
                if (gameRunning) {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    drawBackground();
                    updateParticles();
                    moveSnake();
                    drawParticles();
                    drawFood();
                    drawSnake();
                } else {
                    clearInterval(interval);
                }
            }, gameSpeed);
        }

        // ÊéßÂà∂
        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;
            const LEFT = 37, UP = 38, RIGHT = 39, DOWN = 40;
            const goingRight = dx === 1, goingLeft = dx === -1;
            const goingDown = dy === 1, goingUp = dy === -1;
            
            if (e.keyCode === LEFT && !goingRight) { dx = -1; dy = 0; }
            if (e.keyCode === UP && !goingDown) { dx = 0; dy = -1; }
            if (e.keyCode === RIGHT && !goingLeft) { dx = 1; dy = 0; }
            if (e.keyCode === DOWN && !goingUp) { dx = 0; dy = 1; }
        });

        // Ëß∏ÊéßÊéßÂà∂
        let touchStartX, touchStartY;
        canvas.addEventListener('touchstart', e => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });
        canvas.addEventListener('touchend', e => {
            if (!gameRunning || !touchStartX) return;
            const deltaX = e.changedTouches[0].clientX - touchStartX;
            const deltaY = e.changedTouches[0].clientY - touchStartY;
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 30) {
                dx = deltaX > 0 ? 1 : -1; dy = 0;
            } else if (Math.abs(deltaY) > 30) {
                dy = deltaY > 0 ? 1 : -1; dx = 0;
            }
            touchStartX = touchStartY = null;
        });

        randomFood();
        selectColor(0); // È†êË®≠Á∂†Ëâ≤
    </script>
</body>
</html>
